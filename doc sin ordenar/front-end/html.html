<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HTML</title>
    <link rel="icon" type="image/x-icon" href="/imagenes/MielmaDev/favicon.ico" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Metal+Mania&family=Montserrat:ital,wght@0,100..900;1,100..900&family=Roboto+Flex:wdth,wght@25..151,400&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="estilos/estilo.css" />
    <link rel="stylesheet" href="estilos/acordeon.css" />
  </head>
  <body>
    <header>
      <h1>html</h1>
    </header>
    <article class="html-api">
      <h2>24. API's</h2>

      <p>Una API - Interfaz de Programación de Aplicaciones (del inglés, Application Programming Interface) es un trozo de código que permite a diferentes aplicaciones comunicarse entre sí, compartir información y funcionalidades. Es decir, se trata de un intermediario entre dos sistemas, que permite que una aplicación se comunique con otra y pida datos o acciones específicas.</p>

      <p>Existen APIs de Navegador y APIs de terceros (por ejemplo, la API de YouTube, Vimeo, Google Maps...).</p>

      <p>Con la llegada de mejoras sustanciales y progresivas de HTML a partir del año 2008, tenemos un extenso listado de APIs JavaScript que permiten al Navegador comunicarse con el Sistema Operativo y Hardware del dispositivo para obtener desde las coordenadas GPS de un dispositivo móvil a detectar el nivel de batería que tiene el dispositivo, o poder acceder a la webcam para realizar una videoconferencia, por ejemplo.</p>

      <p>Se pueden encontrar también bajo el nombre de APIs de HTML, pero en realidad se gestiona todo con Javascript y se vuelcan los resultados a la página web. Vamos a ver unas cuantas:</p>

      <h3>Geolocalización</h3>
      <p>La geolocalización consiste en averiguar en qué lugar del mundo nos encontramos exactamente (mediante la dirección IP, conexión de red inalámbrica, torre de señal móvil,GPS, etc.).</p>

      <p>Por políticas de seguridad, los navegadores tienen que pedir autorización expresa para ejecutar esta función Javascript:</p>

      <pre><code>
navigator.geolocation.getCurrentPosition(function (position) {
  let latitud = position.coords.latitude;
  let longitud = position.coords.longitude;
});
</code></pre>

      <dl>
        <dt><code>geolocation</code></dt>
        <dd>Contiene tres métodos para controlar la recuperación de los datos geográficos.</dd>
        <dt><code>position</code></dt>
        <dd>Representa la posición de un dispositivo en un momento dado — esto contiene un objeto <code>Coordinates</code> que contiene la información de la posición actual, además de una marca de tiempo con el momento exacto.</dd>
        <dt><code>coords</code></dt>
        <dd>Contiene una gran cantidad de datos útiles sobre la posición del dispositivo, incluyendo latitud y longitud, altitud, velocidad, dirección de movimiento y más.</dd>
      </dl>

      <p>Podemos obtener las coordenadas y después pasar esos datos a la API de Google Maps para mostrar un plano con el marcador de ubicación en esas coordenadas:</p>

      <div class="ejemplo">
        <p class="botonera">
          <input type="button" value="¿Dónde estoy?" id="btnGeo" />
        </p>
      </div>

      <div id="ejem-geo" style="margin-bottom: 80px">
        <p id="status"></p>
      </div>

      <h3>Pantalla completa (fullscreen)</h3>
      <p>Permite controlar si la página, o un contenido particular de la misma, se muestra a pantalla completa (siempre con permiso previo del usuario) o no.</p>

      <pre><code>
document.getElementById('btnFullMenu').addEventListener(
    'click',
    function(){
        let elem = document.getElementById('indice');
        if (elem.requestFullscreen){
          elem.requestFullscreen();
        }
    },
    false
);
</code></pre>

      <div class="ejemplo">
        <p class="botonera">
          <input type="button" value="Página ⤧" id="btnFullPage" />
          <input type="button" value="Logo ⤧" id="btnFullLogo" />
          <input type="button" value="Menú ⤧" id="btnFullMenu" />
          <input type="button" value="Video ⤧" id="btnFullVideo" />
        </p>
      </div>

      <div class="ej-rwd">
        <div class="rwd-container">
          <video muted playsinline id="videoAurora">
            <source src="../mod-rwd/img/aurora.mp4" type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"' />
          </video>
        </div>
      </div>

      <h3>Batería</h3>
      <p>Podremos detectar el nivel de batería y ejecutar diferentes funciones al respecto. Por motivos de privacidad, algunos navegadores han decidido no implementarlo:</p>
      <p></p>
      <pre><code>
navigator.getBattery().then(function(result) {});

//Resultado:
BatteryManager {
    charging: false,
    chargingTime: Infinity,
    dischargingTime: 8940,
    level: 0.59,
    onchargingchange: null,
    onchargingtimechange: null,
    ondischargingtimechange: null,
    onlevelchange: null
}
</code></pre>

      <h3>Vibración</h3>
      <p>Controla la vibración del dispositivo:</p>
      <pre><code>
navigator.vibrate(1000);
</code></pre>

      <h3>Validación Restringida (formularios) - Constraint Validation API</h3>
      <p>Permite la validación personalizada de los campos de formulario, incluyendo esa validación como si fuera nativa y dejándonos personalizar el mensaje de error.</p>
      <p>Esta API tiene varias funciones asociadas, pero vamos a destacar las siguientes:</p>

      <dl>
        <dt><code>setCustomValidity()</code></dt>
        <dd>Permite modificar el mensaje de validación y las reglas de validación en sí mismas.</dd>
        <dt><code>reportValidity()</code></dt>
        <dd>Devuelve <code>true</code> si el elemento cumple con la validación, y <code>false</code> si no lo hace.</dd>
      </dl>
      <pre><code>
let password1 = document.getElementById('password1');
let password2 = document.getElementById('password2');

if (password1.value != password2.value) {
    password1.setCustomValidity('Los dos campos de Contraseña tienen que coincidir.');
    password1.reportValidity();
} else {
    password1.setCustomValidity('');
}
</code></pre>

      <h3>Drag&Drop</h3>
      <p>Permite agarrar, arrastrar y soltar elementos en una página web.</p>
      <p>Para que el elemento tenga la posibilidad de ser arrastable tenemos que añadirle un atributo:</p>

      <pre><code>
&lt;div class=&quot;elem&quot; draggable=&quot;true&quot;&gt;Elemento&lt;/div&gt;
</code></pre>

      <p>Para detectar si hemos arrastrado un elemento y lo hemos soltado en una zona de la página tenemos varios eventos asociados, como: <code>drag</code>, <code>dragstart</code>, <code>dragenter</code>, <code>dragleave</code>, <code>dragover</code>, <code>drop</code>, <code>dragend</code>...</p>

      <h3>Control de cámara, micrófono y video</h3>
      <p>Podemos controlar la webcam de un usuario así como el micrófono, con el fin de grabar video/audio y procesarlo, realizar una videollamada, etc.</p>

      <h3>Orientación</h3>
      <p>Se puede detectar la orientación y posición de un dispositivo así como si cambia (por ejemplo, si tenemos un juego que detecta si giramos o no el móvil como si fuera el volante de un coche).</p>

      <h3>Almacenamiento (local, sesión y base de datos)</h3>

      <p>Mediante los nuevos sistemas de almacenamiento de HTML 5, vamos a poder almacenar información en el navegador.</p>
      <p>Las cookies, que actualmente utilizamos están pensadas para almacenar una información escasa y los navegadores las envían al servidor cada vez que se recarga la página, por lo que se consume tiempo y ancho de banda extras.</p>
      <p>Por lo tanto, se necesita un nuevo sistema para poder almacenar gran cantidad de información y que el intercambio de esta información entre el navegador y el servidor sea rápida y eficaz.</p>

      <p>Existen 2 tipos de almacenamiento: local y de sesión. En realidad ambos son almacenamiento local (porque se guardan en el navegador), pero se diferencia entre ellos por el tiempo que se mantienen guardados:</p>

      <h3>IndexedDB</h3>
      <p>IndexedDB es una base de datos en el navegador que permite guardar grandes cantidades de datos estructurados. Es más potente que localStorage y sessionStorage, pero también más compleja de usar.</p>
      <pre><code>// Abrir (o crear) una base de datos
let request = indexedDB.open('miBaseDeDatos', 1);
request.onsuccess = function(event) {
  let db = event.target.result;
  // Ya puedes trabajar con la base de datos
};
</code></pre>

      <h3>API de Notificaciones</h3>
      <p>Permite mostrar notificaciones nativas del sistema desde la web. El usuario debe dar permiso.</p>
      <pre><code>Notification.requestPermission().then(function(result) {
  if (result === 'granted') {
    new Notification('¡Hola! Esta es una notificación.');
  }
});
</code></pre>

      <h3>API Fetch</h3>
      <p>La API Fetch permite hacer peticiones HTTP (por ejemplo, para obtener datos de un servidor o una API externa) de forma sencilla y moderna.</p>
      <pre><code>// Hacer una petición GET
fetch('https://jsonplaceholder.typicode.com/todos/1')
  .then(response => response.json())
  .then(data => console.log(data));
</code></pre>

      <h3>API de Notificaciones Push</h3>
      <p>Permite recibir notificaciones push incluso cuando la web está cerrada (requiere Service Worker y configuración en el servidor).</p>
      <pre><code>// Ejemplo muy básico de suscripción (requiere HTTPS y Service Worker)
if ('serviceWorker' in navigator && 'PushManager' in window) {
  navigator.serviceWorker.ready.then(function(registration) {
    registration.pushManager.subscribe({userVisibleOnly: true})
      .then(function(subscription) {
        console.log('Suscrito a notificaciones push');
      });
  });
}
</code></pre>

      <h3>API de Cookies</h3>
      <p>Las cookies permiten guardar pequeños datos en el navegador, como preferencias o sesiones. Se pueden leer y escribir con JavaScript.</p>
      <pre><code>// Crear una cookie
 document.cookie = "usuario=Juan; expires=Fri, 31 Dec 2025 23:59:59 GMT";
// Leer cookies
console.log(document.cookie);
</code></pre>

      <h3>API de History</h3>
      <p>Permite manipular el historial del navegador, útil para aplicaciones de una sola página (SPA).</p>
      <pre><code>// Cambiar la URL sin recargar la página
history.pushState({}, '', '/nueva-url');
// Volver atrás
history.back();
</code></pre>

      <h3>API de Orientación y Movimiento</h3>
      <p>Permite detectar cómo se mueve o gira el dispositivo (móvil/tablet).</p>
      <pre><code>// Detectar orientación del dispositivo
window.addEventListener('deviceorientation', function(event) {
  console.log('Ángulo:', event.alpha, event.beta, event.gamma);
});
</code></pre>

      <h3>API de Web Share</h3>
      <p>Permite compartir contenido desde la web con otras apps (solo en móviles y navegadores compatibles).</p>
      <pre><code>// Compartir texto y URL
if (navigator.share) {
  navigator.share({
    title: 'Título',
    text: 'Texto para compartir',
    url: window.location.href
  });
}
</code></pre>

      <h3>Consejos de seguridad con APIs</h3>
      <ul>
        <li>Algunas APIs requieren permisos del usuario (geolocalización, notificaciones, cámara, etc.).</li>
        <li>Siempre informa al usuario y pide su consentimiento antes de acceder a datos sensibles.</li>
        <li>Revisa la compatibilidad y los riesgos de privacidad antes de usar una API en producción.</li>
      </ul>
      <footer class="pag-pie">
        <p class="titulo-indice articulo-titulo-indice">Referencias</p>
        <ul class="descargas-lista">
          <li><a href="https://developer.mozilla.org/es/docs/Web/API">Todas las APIs</a></li>
          <li><a href="https://developer.chrome.com/blog/voice-driven-web-apps-introduction-to-the-web-speech-api?hl=es-419" rel="external">Aplicaciones controladas por voz</a></li>
          <li><a href="https://www.sitepoint.com/html5-forms-javascript-constraint-validation-api/" rel="external">Validación de Formularios</a></li>
        </ul>
        <p class="titulo-indice">Ejemplos</p>
        <ul class="descargas-lista">
          <li><a href="http://html5demos.com/geo" rel="external">Geolocalización</a></li>
          <li><a href="https://codepen.io/antxoa/pen/ExdMMaw" rel="external">Validación personalizada en formulario</a></li>
          <li><a href="https://code.makery.ch/library/dart-drag-and-drop/" rel="external">Drag</a></li>
          <li><a href="http://nettutsplus.s3.amazonaws.com/64_html5dragdrop/demo/index.html" rel="external">Carrito de la compra con Drag & Drop</a></li>
          <li><a href="https://decafbad.com/2009/07/drag-and-drop/outline.html" rel="external">Reordenar esquema con Drag & Drop</a></li>
          <li><a href="https://webcammictest.io/" rel="external">Prueba de cámara 1</a> y <a href="https://webcamtests.com/" rel="external">Prueba 2</a></li>
          <li><a href="https://mictests.com/" rel="external">Prueba de Micrófono</a></li>
        </ul>
      </footer>
    </article>
    <article class="html-canvas">
      <h2>25. Canvas</h2>
      <p>El elemento <code>canvas</code> es un mapa de bits que puede usarse para renderizar gráficos, juegos, o cualquier otra imagen visual, en tiempo real.</p>
      <pre><code>&lt;canvas id=&quot;canvas-prueba&quot;&gt;&lt;/canvas&gt;
</code></pre>
      <p>Es un lienzo en blanco sobre el que podemos dibujar lo que queramos e interactuar con él (mediante Javascript).</p>
      <p>Para ello tenemos unas APIs de dibujo 2D y 3D así como otras de interacción y más funcionalidades. Podemos insertar textos, imágenes y videos, para su posterior manipulación.</p>
      <footer class="pag-pie">
        <p class="titulo-indice">Referencias</p>
        <ul class="descargas-lista">
          <li>
            <a href="https://web.archive.org/web/20240831144559/https://www.html5canvastutorials.com/tutorials/html5-canvas-element/" rel="external">Tutorial 1</a> y
            <a href="https://developer.mozilla.org/es/docs/Web/API/Canvas_API/Tutorial" rel="external">Tutorial 2</a>
          </li>
          <li><a href="https://codepen.io/antxoa/pen/LYQEKwe" rel="external">Rectángulos y formas básicas</a></li>
        </ul>
        <p class="titulo-indice articulo-titulo-indice">Ejemplos</p>
        <ol class="descargas-lista">
          <li><a href="https://worldsbiggestpacman.com/" rel="external">Pacman</a></li>
          <li><a href="http://www.effectgames.com/demos/canvascycle/" rel="external">Animación</a></li>
          <li><a href="https://craftymind.com/factory/html5video/CanvasVideo.html" rel="external">Destrucción de un video</a></li>
          <li><a href="https://codepen.io/binacio/pen/gONpzQ" rel="external">Paint básico</a></li>
          <li><a href="https://alteredqualia.com/canvasmol/" rel="external">Moléculas</a></li>
          <li><a href="https://codepen.io/zadvorsky/pen/xxwbBQV" rel="external">Simulador de gente</a></li>
          <li><a href="https://codepen.io/dcode-software/pen/OJgJdQw" rel="external">Generador de Memes</a></li>
          <li><a href="https://www.kesiev.com/akihabara/" rel="external">Más juegos</a></li>
        </ol>
      </footer>
    </article>
  </body>
  <script src="../javascript/script.js"></script>
</html>
